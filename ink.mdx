---
title: 'Ink Library'
description: 'A powerful, lightweight handwriting math recognition library for the web.'
icon: 'pen-nib'
---

<img className="block dark:hidden" src="/logo/ink.png" alt="Ink Logo" width="200" />
<img className="hidden dark:block" src="/logo/ink.png" alt="Ink Logo" width="200" />

**@impulsedev/ink** is a specialized library designed to recognize handwritten digits and mathematical operators directly in the browser. It features a unique **client-side auto-training** capability, allowing it to adapt and learn without heavy server-side models.

## Key Features

- **Math Recognition**: accurate detection of digits (0-9) and operators (+, -, *, /, =).
- **Auto-Training**: The library can train its own lightweight CNN model in the browser using bundled sample data. Zero server configuration required.
- **Expression Evaluation**: Automatically parses recognized characters into valid mathematical expressions and calculates the result.
- **Stroke Management**: Built-in tools for capturing, storing, and manipulating handwriting strokes.
- **TypeScript Support**: Fully typed for a robust development experience.

## Installation

Install the package via npm:

```bash
npm install @impulsedev/ink
```

## Quick Start

Here is a minimal example to initialize the library and recognize a simple drawing.

```typescript
import { Ink } from '@impulsedev/ink';

// Initialize Ink
// By default, this starts the auto-training process in the background
const ink = new Ink();

// Wait for the model to be ready (trains or loads)
await ink.loadModel();

// ... (Integration with your canvas to capture strokes) ...

// Recognize the current drawing
const result = await ink.recognize();

if (result.valid) {
  console.log(`Expression: ${result.expression}`); // Output: "2 + 2"
  console.log(`Result: ${result.result}`);         // Output: 4
}
```

## Usage Guide

### Capturing Strokes
`Ink` provides a stroke management system that easily integrates with standard HTML5 Canvas events.

```typescript
const canvas = document.getElementById('myCanvas');
const ink = new Ink();
let isDrawing = false;

canvas.addEventListener('mousedown', (e) => {
  isDrawing = true;
  // Start tracking a new stroke
  const stroke = ink.startStroke();
  stroke.addPoint(e.offsetX, e.offsetY);
});

canvas.addEventListener('mousemove', (e) => {
  if (!isDrawing) return;
  // Add points to the active stroke
  const strokes = ink.getStrokes();
  const currentStroke = strokes[strokes.length - 1];
  currentStroke.addPoint(e.offsetX, e.offsetY);
  
  // (Optional) Draw to canvas context here for visual feedback
});

canvas.addEventListener('mouseup', () => {
  isDrawing = false;
});
```

### Auto-Training Options
You can customize how the library trains itself via the `InkOptions` object passed to the constructor.

```typescript
const ink = new Ink({
  auto: true,                // Enable auto-training (default: true)
  autoEpochs: 20,            // Increase epochs for potentially better accuracy
  autoAugmentFactor: 5,      // Generate more variations of sample data
  onTrainProgress: (epoch, total, logs) => {
    console.log(`Training progress: ${Math.round(epoch / total * 100)}%`);
  }
});
```

<Tip>
  **Performance Note**: Auto-training happens on the main thread in this version. For complex applications, consider running training during an initialization phase or loading screen.
</Tip>

## API Reference

### `Ink` Class

#### `constructor(options?: InkOptions)`
Creates a new instance of the Ink recognition engine.

**`InkOptions` Properties:**
- `auto` (boolean): Whether to automatically train the model on load.
- `modelUrl` (string): Path to a pre-trained TensorFlow.js model JSON file (disables auto-training if provided).
- `trainingData` (Record): Custom data to train on.
- `onTrainProgress` (function): Callback for monitoring training status.

#### `loadModel(): Promise<void>`
Initializes the model. If `auto` is true, this triggers the training process using bundled data.

#### `isReady(): boolean`
Returns `true` if the model is trained/loaded and ready to recognize input.

#### `startStroke(): Stroke`
Creates a brand new stroke and returns it. Future points should be added to this object.

#### `undo(): Stroke | undefined`
Removes the most recently added stroke from the internal history. Useful for building "Undo" UI buttons.

#### `clear(): void`
Resets the internal state, removing all strokes.

#### `recognize(): Promise<InkResult>`
asynchronously processes all current strokes and returns the recognition result.

### `InkResult` Interface

The object returned by `recognize()` contains:

- **`expression`** (`string`): The normalized mathematical expression (e.g., "1 + 2").
- **`result`** (`number | null`): The evaluated result of the expression.
- **`valid`** (`boolean`): `true` if the input was successfully parsed as valid math.
- **`characters`** (`RecognitionResult[]`): Array containing confidence scores and bounding boxes for each recognized symbol.

## License

This library is licensed under the **ISC License**.
